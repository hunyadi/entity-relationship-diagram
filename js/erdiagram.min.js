/**
 * Entity Relationship Diagram (in TypeScript)
 * @author  Levente Hunyadi
 * @version 1.0
 * @remarks Copyright (C) 2022-2024 Levente Hunyadi
 * @remarks Licensed under MIT, see https://opensource.org/licenses/MIT
 * @see     https://github.com/hunyadi/entity-relationship-diagram/
 **/
(()=>{"use strict";var t={537:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BooleanMatrix=void 0,e.BooleanMatrix=class{constructor(t,e){this.rows=t,this.cols=e,this.stride=(e+7)/8|0,this.array=new Uint8Array(t*this.stride)}getByteIndex(t,e){return t*this.stride+(e/8|0)}getByteValue(t,e){return this.array[this.getByteIndex(t,e)]}get(t,e){if(t<0||t>=this.rows||e<0||e>=this.cols)throw RangeError("array index out of bounds");return!!(this.getByteValue(t,e)&1<<e%8)}set(t,e,s){if(t<0||t>=this.rows||e<0||e>=this.cols)throw RangeError("array index out of bounds");let i=this.getByteValue(t,e);s?i|=1<<e%8:i&=~(1<<e%8),this.array[this.getByteIndex(t,e)]=i}}},469:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Arrow=e.DiagramCanvas=void 0;const i=s(582),r=s(383),o=s(949);class n{constructor(t){this.elem=t}get element(){return this.elem}}class a extends n{constructor(t,e,s){super(t),this.sourceElement=e,this.targetElement=s}get source(){return this.sourceElement}get target(){return this.targetElement}remove(){this.elem.remove()}}var c;!function(t){t.Regular="regular",t.SourceSelected="source-selected",t.TargetSelected="target-selected"}(c||(c={})),e.DiagramCanvas=class{constructor(t){this.elements=[],this.connectors=[],this.repainting=!1,this.markerWidth=10,this.markerHeight=7,this.markers=new Map;const e=document.createElement("div");e.classList.add("diagram-canvas");const s=document.createDocumentFragment();for(let e of t.children)s.append(e);this.svg=(0,r.createSVGElement)("svg"),this.initializeConnectorLayer(),e.append(this.svg),this.host=document.createElement("div"),this.host.append(s),e.append(this.host),new ResizeObserver(this.redraw.bind(this)).observe(this.host),this.resizeObserver=new ResizeObserver(this.redraw.bind(this)),this.styleObserver=new MutationObserver(this.redraw.bind(this)),this.childObserver=new MutationObserver((t=>{let e=new Set;t.forEach((t=>{t.removedNodes.forEach((t=>{this.connectors.forEach((s=>{(t.contains(s.source)||t.contains(s.target))&&e.add(s)}))}))})),e.forEach((t=>{t.remove()})),this.connectors=this.connectors.filter((t=>!e.has(t)))})),this.element=e,this.clear()}initializeConnectorLayer(){this.markers.set("regular",(0,o.makeIdentifier)()),this.markers.set("source-selected",(0,o.makeIdentifier)()),this.markers.set("target-selected",(0,o.makeIdentifier)());const t=(0,r.createSVGElement)("defs"),e=[];for(let[t,s]of this.markers.entries()){const i=`<polygon fill="currentColor" points="0 0, ${this.markerWidth} ${this.markerHeight/2}, 0 ${this.markerHeight}" />`,r=`<marker id="${s}" class="${t}" markerWidth="${this.markerWidth}" markerHeight="${this.markerHeight}" refX="${this.markerWidth}" refY="${this.markerHeight/2}" orient="auto">${i}</marker>`;e.push(r)}t.innerHTML=e.join(""),this.svg.append(t)}isConnectedTo(t,e){return this.connectors.some((s=>t.contains(s.source)&&e.contains(s.target)))}isConnected(t,e){return this.isConnectedTo(t,e)||this.isConnectedTo(e,t)}addElement(t){this.elements.push(t),this.host.contains(t)||this.host.append(t),t.addEventListener("mousedown",(()=>{this.elements.forEach((t=>{t.classList.remove("selected")})),t.classList.add("selected")}))}addConnector(t){this.connectors.push(t),this.svg.appendChild(t.element),this.observeConnectorEndpoint(t.source),this.observeConnectorEndpoint(t.target)}removeConnector(t){const e=this.connectors.filter((e=>e!==t));t.remove(),this.resizeObserver.disconnect(),e.forEach((t=>{this.addConnector(t)}))}clear(){this.childObserver.disconnect(),this.connectors.forEach((t=>{t.remove()})),this.resizeObserver.disconnect(),this.connectors=[],this.elements.forEach((t=>{t.remove()})),this.elements=[],this.childObserver.observe(this.host,{subtree:!0,childList:!0}),this.styleObserver.observe(this.host,{subtree:!0,attributeFilter:["class","style"]})}observeConnectorEndpoint(t){this.resizeObserver.observe(t),t.offsetParent&&this.resizeObserver.observe(t.offsetParent)}getBoundingRect(t){const e=t.getBoundingClientRect(),s=this.svg.getBoundingClientRect();return new i.Rect(e.left-s.left,e.top-s.top,e.right-s.left,e.bottom-s.top)}shuffle(){for(let t of this.host.children){const e=t,s=this.host.offsetWidth,i=this.host.offsetHeight,r=e.offsetWidth,o=e.offsetHeight;e.style.left=Math.random()*(s-r)+"px",e.style.top=Math.random()*(i-o)+"px"}}redraw(){this.repainting||(window.requestAnimationFrame(this.repaint.bind(this)),this.repainting=!0)}repaint(){if(this.connectors.length>0){const t=new r.FirstVisibleAncestor,e=new r.IsAncestorSelected("selected",this.host);this.connectors.forEach((s=>{s.draw(this,t,e)}))}this.repainting=!1}},e.Arrow=class extends a{get path(){return this.elem}constructor(t,e){const s=(0,r.createSVGElement)("path");s.setAttribute("stroke","currentColor"),s.setAttribute("fill","transparent"),super(s,t,e)}draw(t,e,s){let r=e.get(this.source),o=e.get(this.target);const n=this.path.classList.contains("source-selected"),a=this.path.classList.contains("target-selected");if(r==o)return this.path.classList.remove("source-selected"),this.path.classList.remove("target-selected"),this.path.removeAttribute("d"),void this.path.removeAttribute("marker-end");const c=t.getBoundingRect(r),h=t.getBoundingRect(o);let l,d,u,p,m=0,g=0,f=(c.top+c.bottom)/2,y=(h.top+h.bottom)/2;if(h.left-c.right>3*t.markerWidth||c.left-h.right>3*t.markerWidth){c.right<h.left?(m=c.right,g=h.left):(m=c.left,g=h.right),l=new i.Point(m,f),p=new i.Point(g,y);const t=(l.x+p.x)/2;d=new i.Point(t,l.y),u=new i.Point(t,p.y)}else{let t=0;Math.abs(c.left-h.left)<Math.abs(c.right-h.right)?(m=c.left,g=h.left,t=-(c.width+h.width)/2):(m=c.right,g=h.right,t=(c.width+h.width)/2),l=new i.Point(m,f),p=new i.Point(g,y),d=new i.Point(m+t,l.y),u=new i.Point(g+t,p.y)}const w=`M${l.x} ${l.y} C${d.x} ${d.y} ${u.x} ${u.y} ${p.x} ${p.y}`;this.path.setAttribute("d",w);let v=t.markers.get("regular");s.get(this.source)?(this.path.classList.add("source-selected"),this.path.classList.remove("target-selected"),v=t.markers.get("source-selected"),n||this.path.parentNode.appendChild(this.path)):s.get(this.target)?(this.path.classList.remove("source-selected"),this.path.classList.add("target-selected"),v=t.markers.get("target-selected"),a||this.path.parentNode.appendChild(this.path)):(this.path.classList.remove("source-selected"),this.path.classList.remove("target-selected")),this.path.setAttribute("marker-end",`url(#${v})`)}}},727:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ElasticLayout=void 0;const i=s(537),r=s(321),o=s(582);function n(t,e,s){return t<=e?e:t>=s?s:t}class a{constructor(t){this.element=t,this.force=new o.Vector(0,0),this.velocity=new o.Vector(0,0),this.position=new o.Vector(0,0),this.size=new o.Size(0,0)}get mass(){return 1}}e.ElasticLayout=class{constructor(t,e,s,r){this.options=t,this.canvas=e,this.lastTimestamp=0,this.running=!1,this.objects=s.map((t=>new a(t))),this.connectivity=new i.BooleanMatrix(s.length,s.length);for(let[t,e]of this.objects.entries())for(let[s,i]of this.objects.entries())this.connectivity.set(t,s,r(e.element,i.element))}getCenterPosition(){const t=this.canvas.getBoundingClientRect();return new o.Vector(t.width/2,t.height/2)}getDynamicObjects(){return this.objects.filter((t=>"important"!=t.element.style.getPropertyPriority("left")&&"important"!=t.element.style.getPropertyPriority("top")))}loadPosition(t){const e=this.canvas.getBoundingClientRect(),s=new o.Point(e.x,e.y);t.forEach((t=>{const e=(0,r.getOffsetRect)(t.element,s);t.position=o.Vector.from(e.center),t.size=new o.Size(e.width,e.height)}))}savePosition(t){t.forEach((t=>{t.element.style.left=t.position.x-t.size.width/2+"px",t.element.style.top=t.position.y-t.size.height/2+"px",t.position.x=n(t.position.x,-5e3,5e3),t.position.y=n(t.position.y,-5e3,5e3)}))}isConnected(t,e){const s=this.objects.indexOf(t),i=this.objects.indexOf(e);return this.connectivity.get(s,i)}initialize(){const t=this.getCenterPosition(),e=this.getDynamicObjects();this.loadPosition(e),this.step(t,e,.1);for(let s=0;s<this.options.iterations;++s)this.step(t,e,.1);this.reset(t,e),this.savePosition(e),this.running=!1,this.start()}start(){this.running=!0,this.lastTimestamp=performance.now(),window.requestAnimationFrame(this.tick.bind(this))}stop(){this.running=!1}reset(t,e){const s=o.Vector.mean(e.map((t=>t.position))),i=t.minus(s);e.forEach((t=>{t.position.add(i),t.velocity=new o.Vector(0,0),t.force=new o.Vector(0,0)}))}step(t,e,s){e.forEach((t=>{let e=t.velocity.times(s);t.position.add(e)})),e.forEach((t=>{t.velocity=t.force.times(s/t.mass)}));for(let s=0;s<e.length;++s){const i=e[s],r=t.minus(i.position).normalize().times(this.options.gravity);i.force.add(r);const o=i.velocity.times(-this.options.drag);i.force.add(o);for(let t=s+1;t<e.length;++t){const s=e[t],r=s.position.minus(i.position),o=r.magnitude();r.normalize();const n=r.times(this.options.charge*this.options.charge/(1+o*o));if(i.force.add(n.reversed()),s.force.add(n),this.isConnected(i,s)){const t=r.times(this.options.stiffness*o);i.force.add(t),s.force.add(t.reversed())}}}}tick(t){let e=(t-this.lastTimestamp)/1e3;e>5&&(e=5);const s=this.getCenterPosition(),i=this.getDynamicObjects();for(this.loadPosition(i);e>.1;)this.step(s,i,.1),e-=.1;this.step(s,i,e),this.savePosition(i),this.running&&(this.lastTimestamp=t,window.requestAnimationFrame(this.tick.bind(this)))}}},582:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Size=e.Rect=e.Vector=e.Point=void 0;class s{constructor(t,e){this.x=t,this.y=e}static combine(t,e){if(t.length!=e.length)throw RangeError("input array size mismatch");const i=new Array(t.length),r=t.length;for(let o=0;o<r;++o)i[o]=new s(t[o],e[o]);return i}}e.Point=s;class i{constructor(t,e){this.x=t,this.y=e}static from(t){return new i(t.x,t.y)}static combine(t,e){if(t.length!=e.length)throw RangeError("input array size mismatch");const s=[],r=t.length;for(let o=0;o<r;++o)s.push(new i(t[o],e[o]));return s}static mean(t){return t.reduce(((t,e)=>t.add(e)),new i(0,0)).divide(t.length)}static rescale(t){if(t.length>0){const e=t[0],s=t.reduce(((t,e)=>Math.min(t,e.x)),e.x),r=t.reduce(((t,e)=>Math.max(t,e.x)),e.x),o=t.reduce(((t,e)=>Math.min(t,e.y)),e.y),n=t.reduce(((t,e)=>Math.max(t,e.y)),e.y);return t.map((t=>new i((t.x-s)/(r-s),(t.y-o)/(n-o))))}return[]}magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y)}reversed(){return new i(-this.x,-this.y)}plus(t){return new i(this.x+t.x,this.y+t.y)}minus(t){return new i(this.x-t.x,this.y-t.y)}times(t){return new i(this.x*t,this.y*t)}canonicalize(){const t=this.magnitude();return t!=t&&(this.x=0,this.y=0),this}normalize(){const t=this.magnitude();return t?(this.x/=t,this.y/=t):(this.x=0,this.y=0),this}add(t){return this.x+=t.x,this.y+=t.y,this}subtract(t){return this.x-=t.x,this.y-=t.y,this}multiply(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t,this.y/=t,this}}e.Vector=i,e.Rect=class{constructor(t,e,s,i){this.left=t,this.top=e,this.right=s,this.bottom=i}get width(){return this.right-this.left}get height(){return this.bottom-this.top}get center(){return new s((this.left+this.right)/2,(this.top+this.bottom)/2)}get position(){return new s(this.left,this.top)}},e.Size=class{constructor(t,e){this.width=t,this.height=e}}},383:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.IsAncestorSelected=e.FirstVisibleAncestor=void 0,e.createSVGElement=function(t){return document.createElementNS("http://www.w3.org/2000/svg",t)};class s{constructor(t){this.compute=t,this.cache=new Map}get(t){let e=this.cache.get(t);return void 0===e&&(e=this.compute(t),this.cache.set(t,e)),e}}e.FirstVisibleAncestor=class extends s{constructor(){super((t=>{for(;null==t.offsetParent&&null!=t.parentElement;)t=t.parentElement;return t}))}},e.IsAncestorSelected=class extends s{constructor(t,e){super((s=>{for(;s!=e&&!s.classList.contains(t);)s=s.parentElement;return s!=e}))}}},321:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getOffsetRect=function(t,e){const s=t.getBoundingClientRect();return new i.Rect(s.left-e.x,s.top-e.y,s.right-e.x,s.bottom-e.y)},e.setPosition=function(t,e,s){let i,o;if(function(t){const e=t.style,s=r(e.getPropertyValue("left"))||r(e.getPropertyValue("right")),i=r(e.getPropertyValue("top"))||r(e.getPropertyValue("bottom"));return s&&i}(t)){const s=t.offsetParent,r=s.offsetWidth,n=s.offsetHeight;i=100*e.x/r+"%",o=100*e.y/n+"%"}else i=e.x+"px",o=e.y+"px";const n=s?"important":"",a=t.style;a.setProperty("left",i,n),a.setProperty("top",o,n),a.removeProperty("right"),a.removeProperty("bottom")};const i=s(582);function r(t){return null!==t.match("^-?[0-9][.0-9]*%$")}},65:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.downloadSVG=function(t){const e=(new XMLSerializer).serializeToString(t),s="data:image/svg+xml;charset=utf-8,"+encodeURIComponent('<?xml version="1.0" encoding="utf-8"?>'+e),i=document.createElement("a");i.href=s,i.download="diagram.svg",document.body.appendChild(i),i.click(),document.body.removeChild(i)},e.toSVG=function(t){return new d(t).build()};const i=s(582),r=s(949);function o(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function n(t,e){const s=o(t);return s.setAttribute("x",`${e.left}`),s.setAttribute("y",`${e.top}`),s.setAttribute("width",`${e.width}`),s.setAttribute("height",`${e.height}`),s}function a(t,e){const s=window.getComputedStyle(t,e).getPropertyValue("content"),i=/^"(.*)"$/.exec(s);if(i)return i[1].replace('\\"','"').replace("\\'","'").replace("\\\\","\\")}function c(t){const e=[];for(let[s,i]of Object.entries(t))e.push(`${s}:${i};`);return e.join("")}function h(t){const e={},s=["font-family","font-size","font-style","font-variant","font-weight"];for(let i of s){const s=t.getPropertyValue(i);s&&(e[i]=s)}return e}class l{constructor(){this.styleToClass=new Map,this.typeToStyle=new Map}setDefault(t,e){const s=c(e);this.typeToStyle.set(t,s)}assignByTypeValue(t,e){const s=c(e);if(this.typeToStyle.get(t)!=s)return this.assignByString(s)}assignByValue(t){return this.assignByString(c(t))}assignByString(t){let e=this.styleToClass.get(t);return e||(e=(0,r.makeIdentifier)(),this.styleToClass.set(t,e)),e}build(){const t=[];return this.typeToStyle.forEach(((e,s)=>{t.push(`${s}{${e}}`)})),this.styleToClass.forEach(((e,s)=>{t.push(`.${e}{${s}}`)})),t.join("\n")}}class d{constructor(t){this.viewport=new i.Rect(0,0,0,0),this.catalog=new l,this.container=t,this.root=o("svg"),this.defs=o("defs")}build(){const t=h(window.getComputedStyle(this.container));this.catalog.setDefault("text",t);const e=this.container.getBoundingClientRect();this.viewport=new i.Rect(e.left,e.top,e.right,e.bottom);const s=o("svg");s.setAttribute("viewBox",`0 0 ${this.viewport.width} ${this.viewport.height}`),Array.from(this.container.children).forEach((t=>{this.root.append(...this.visit(t))})),this.defs.childElementCount>0&&s.appendChild(this.defs);const r=o("style");return r.innerHTML="text{dominant-baseline:central}"+this.catalog.build(),s.append(r),s.append(...this.root.children),this.root=o("svg"),this.defs=o("defs"),s}getPositionSize(t){const e=t.getBoundingClientRect();return new i.Rect(e.left-this.viewport.left,e.top-this.viewport.top,e.right-this.viewport.left,e.bottom-this.viewport.top)}visitSVG(t){const e=o("svg");Array.from(t.children).forEach((t=>{"defs"===t.tagName.toLowerCase()?Array.from(t.children).forEach((t=>{this.defs.append(t.cloneNode(!0))})):e.append(t.cloneNode(!0))}));const s=this.getPositionSize(t);return e.setAttribute("x",`${s.left}`),e.setAttribute("y",`${s.top}`),e.setAttribute("width",`${s.width}`),e.setAttribute("height",`${s.height}`),e}visitTable(t){const e=this.getPositionSize(t),s=window.getComputedStyle(t),i=o("g"),r=n("rect",e);return r.setAttribute("class",this.catalog.assignByValue({stroke:s.borderTopColor,"stroke-width":s.borderTopWidth,fill:s.backgroundColor})),i.append(r),Array.from(t.rows).forEach((t=>{i.append(this.visitTableRow(t))})),i}visitTableRow(t){const e=this.getPositionSize(t),s=window.getComputedStyle(t),i=o("g"),r=n("rect",e);return r.setAttribute("class",this.catalog.assignByValue({stroke:s.borderTopColor,"stroke-width":s.borderTopWidth,fill:s.backgroundColor})),i.append(r),Array.from(t.cells).forEach((t=>{i.append(...this.visit(t))})),i}createSVGText(t,e,s){const r=function(t,e){const s=o("text");return s.setAttribute("x",`${e.x}`),s.setAttribute("y",`${e.y}`),s}(0,new i.Point(e.left,.5*(e.top+e.bottom))),n=this.catalog.assignByTypeValue("text",h(window.getComputedStyle(s)));return n&&r.setAttribute("class",n),r.innerHTML=t,r}visitText(t,e){const s=document.createRange();s.selectNode(t);const i=this.getPositionSize(s);return this.createSVGText((t.nodeValue||"").trim(),i,e)}visitElement(t){if(!t.offsetParent)return[];const e=[],s=this.getPositionSize(t),i=a(t,":before");i&&e.push(this.createSVGText(i,s,t)),e.push(...this.visitChildren(t));const r=a(t,":after");return r&&e.push(this.createSVGText(r,s,t)),e}visitChildren(t){const e=[];return t.childNodes.forEach((s=>{s.nodeType==Node.ELEMENT_NODE?e.push(...this.visit(s)):s.nodeType==Node.TEXT_NODE&&s.nodeValue&&e.push(this.visitText(s,t))})),e}visit(t){switch(t.tagName.toLowerCase()){case"svg":return[this.visitSVG(t)];case"table":return[this.visitTable(t)];default:return this.visitElement(t)}}}},499:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Jacobi=e.RealMatrix=void 0,e.sortedIndexArray=function(t){return Array.from(Array(t.length).keys()).sort(((e,s)=>{const i=t[e],r=t[s];return i<r?-1:r<i?1:0}))};class s{constructor(t){t instanceof Float64Array?(this.data=t,this.size=this.data.length):(this.size=t,this.data=new Float64Array(this.size))}get(t){return this.data[t]}set(t,e){this.data[t]=e}duplicate(){const t=new Float64Array(this.data.length);return t.set(this.data),new s(t)}subarray(t,e){return new s(this.data.subarray(t,e))}sum(){return this.data.reduce(((t,e)=>t+e),0)}prod(){return this.data.reduce(((t,e)=>t*e),1)}add(t){for(let e=0;e<this.size;++e)this.data[e]+=t.get(e);return this}subtract(t){for(let e=0;e<this.size;++e)this.data[e]-=t.get(e);return this}copyFrom(t){this.data.set(t)}toArray(){return Array.from(this.data)}}class i{constructor(t,e,s){this.data=t,this.rows=e,this.cols=s}get(t,e){return this.data.get(t*this.cols+e)}set(t,e,s){return this.data.set(t*this.cols+e,s)}row(t){const e=t*this.rows;return this.data.subarray(e,e+this.rows)}compareShape(t){if(this.rows!=t.rows||this.cols!=t.cols)throw RangeError("incompatible matrix dimensions")}add(t){return this.compareShape(t),this.data.add(t.data),this}subtract(t){return this.compareShape(t),this.data.subtract(t.data),this}plus(t){return this.duplicate().add(t)}minus(t){return this.duplicate().subtract(t)}rowSum(){return Array.from({length:this.rows},((t,e)=>this.row(e).sum()))}toArray(){return Array.from({length:this.rows},((t,e)=>this.row(e).toArray()))}}class r extends i{static zeros(t,e){return new r(new s(t*e),t,e)}static eye(t,e){const s=r.zeros(t,e);for(let i=0;i<Math.min(t,e);++i)s.set(i,i,1);return s}static copy(t){return new r(t.data.duplicate(),t.rows,t.cols)}static diag(t){const e=t.length,s=r.zeros(e,e);for(let i=0;i<e;++i)s.set(i,i,t[i]);return s}static from(t){const e=t.length,s=t[0].length,i=r.zeros(e,s);for(let r=0;r<e;++r)for(let e=0;e<s;++e)i.set(r,e,t[r][e]);return i}duplicate(){return new r(this.data.duplicate(),this.rows,this.cols)}transpose(){const t=r.zeros(this.cols,this.rows);for(let e=0;e<this.rows;++e)for(let s=0;s<this.cols;++s)t.set(s,e,this.get(e,s));return t}diag(){const t=Math.min(this.rows,this.cols),e=new s(t);for(let s=0;s<t;++s)e.set(s,this.get(s,s));return e}mtimes(t){const e=r.zeros(this.rows,t.cols);for(let s=0;s<this.rows;++s)for(let i=0;i<this.cols;++i){let r=0;for(let e=0;e<this.rows;++e)r+=this.get(s,e)*t.get(e,i);e.set(s,i,r)}return e}}e.RealMatrix=r;class o{constructor(t){this.A=r.copy(t),this.Q=r.eye(t.rows,t.cols)}run(){for(let t=0;t<1e3;t++){let t=this.computeMaximum();if(2*t.value<o.TOLERANCE)break;const[e,s]=this.computeRotation(t.row,t.col);this.updateMatrices(t.row,t.col,e,s)}return this}get eigenvalues(){return this.A.diag().toArray()}get eigenvectors(){return Array.from({length:this.Q.rows},((t,e)=>this.Q.row(e)))}computeMaximum(){let t=0,e=0,s=-Number.MAX_VALUE;const i=this.A.rows;for(let r=0;r<i-1;r++)for(let o=r+1;o<i;o++)Math.abs(this.A.get(r,o))>s&&(t=r,e=o,s=Math.abs(this.A.get(r,o)));return{row:t,col:e,value:s}}computeRotation(t,e){let s=(this.A.get(t,t)-this.A.get(e,e))/2/this.A.get(t,e);return s/=Math.sqrt(1+s*s),[Math.sqrt(.5+s/2),Math.sqrt(.5-s/2)]}updateMatrices(t,e,s,i){const r=this.A.rows;for(let o=0;o<r;o++){const r=s*this.A.get(t,o)+i*this.A.get(e,o),n=-i*this.A.get(t,o)+s*this.A.get(e,o);this.A.set(t,o,r),this.A.set(e,o,n)}for(let o=0;o<r;o++){const r=s*this.A.get(o,t)+i*this.A.get(o,e),n=-i*this.A.get(o,t)+s*this.A.get(o,e);this.A.set(o,t,r),this.A.set(o,e,n)}for(let o=0;o<r;o++){const r=s*this.Q.get(t,o)+i*this.Q.get(e,o),n=-i*this.Q.get(t,o)+s*this.Q.get(e,o);this.Q.set(t,o,r),this.Q.set(e,o,n)}}}e.Jacobi=o,o.TOLERANCE=1e-6},442:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Pannable=e.Movable=void 0;const i=s(582),r=s(321);class o{constructor(t,e){this.relatedElement=e,this.mousePos=new i.Vector(0,0),this.mouseMoveListener=t=>{var e;t.preventDefault(),t.stopPropagation(),null===(e=document.getSelection())||void 0===e||e.empty(),this.update(t,!0)},t.addEventListener("mousedown",(e=>{e.target==t&&(this.mousePos=new i.Vector(e.clientX,e.clientY),this.capture(),document.addEventListener("mouseup",(t=>{document.removeEventListener("mousemove",this.mouseMoveListener,!0),this.update(t,!1)}),{once:!0}),document.addEventListener("mousemove",this.mouseMoveListener,!0))}))}}e.Movable=class extends o{constructor(){super(...arguments),this.elementPos=new i.Vector(0,0)}capture(){this.elementPos=new i.Vector(this.relatedElement.offsetLeft,this.relatedElement.offsetTop)}update(t,e){const s=new i.Vector(t.clientX,t.clientY).minus(this.mousePos),o=this.elementPos.plus(s);(0,r.setPosition)(this.relatedElement,o,e)}},e.Pannable=class extends o{constructor(){super(...arguments),this.positions=new Map}capture(){for(let t of this.relatedElement.children){const e=t;this.positions.set(e,new i.Vector(e.offsetLeft,e.offsetTop))}}update(t,e){const s=new i.Vector(t.clientX,t.clientY).minus(this.mousePos);for(let t of this.relatedElement.children){const i=t,o=this.positions.get(i).plus(s);(0,r.setPosition)(i,o,e)}}}},262:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0});const i=s(582),r=s(499);e.default=class{constructor(t,e){this.nodes=t,this.edges=e}calculate(){const t=r.RealMatrix.zeros(this.nodes.length,this.nodes.length);this.edges.forEach((e=>{const s=this.nodes.indexOf(e.source),i=this.nodes.indexOf(e.target);t.set(s,i,1),t.set(i,s,1)}));const e=r.RealMatrix.diag(t.rowSum()).minus(t),s=new r.Jacobi(e).run(),o=s.eigenvalues,n=(0,r.sortedIndexArray)(o);let a=0;for(;o[n[a]]<1e-6;)++a;const c=s.eigenvectors,h=i.Vector.combine(c[n[a]].toArray(),c[n[a+1]].toArray());for(let t=0;t<this.nodes.length;++t)h[t].canonicalize();for(let t=0;t<this.nodes.length;++t){const e=h[t],s=new Set;s.add(t);for(let i=t+1;i<this.nodes.length;++i)h[i].minus(e).magnitude()<1e-8&&s.add(i);if(s.size>1){for(let t=0;t<this.nodes.length;++t)if(!s.has(t)){const s=h[t].minus(e).normalize().multiply(.2);h[t].add(s)}const t=s.size;for(let[e,r]of s.entries()){const s=new i.Vector(Math.cos(2*r*Math.PI/t),Math.sin(2*r*Math.PI/t)).multiply(.1);h[e].add(s)}}}for(let t=0;t<this.nodes.length;++t){const e=h[t];for(let s=t+1;s<this.nodes.length;++s){const t=h[s];if(t.minus(e).magnitude()<.1){const s=e.plus(t).multiply(.5);for(let t=0;t<this.nodes.length;++t)h[t].add(h[t].minus(s).normalize().multiply(.1))}}}return i.Vector.rescale(h)}}},221:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(t){this.view=t.querySelector(".tab-view"),this.selector=t.querySelector(".tab-selector");for(let t of this.selector.children)t.addEventListener("click",(t=>{const e=t.target;this.activateByName(e.dataset.tab)}));this.activateByIndex(0)}activateByIndex(t){this.deactivateTabs();const e=this.selector.children[t],s=this.view.children[t];this.activateTab(e,s)}activateByName(t){this.deactivateTabs();const e=this.selector.querySelector('[data-tab="'+t+'"]'),s=this.view.querySelector('[data-tab="'+t+'"]');this.activateTab(e,s)}activateTab(t,e){t&&t.classList.add("tab-active"),e&&e.classList.add("tab-active")}deactivateTabs(){for(let t of this.selector.children)t.classList.remove("tab-active");for(let t of this.view.children)t.classList.remove("tab-active")}}},949:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.makeIdentifier=function(t=8){const e=Array.from({length:t},(()=>Math.floor(36*Math.random()).toString(36)));return e[0]=Math.floor(10+26*Math.random()).toString(36),e.join("")}},137:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0});const i=s(582),r=s(321);class o{constructor(t,e){this.zoomIndex=o.zoomLevels.indexOf(1),t.addEventListener("wheel",(s=>{s.preventDefault(),s.stopPropagation();const n=o.zoomLevels[this.zoomIndex];s.deltaY>0&&this.zoomIndex>0?this.zoomIndex-=1:s.deltaY<0&&this.zoomIndex<o.zoomLevels.length-1&&(this.zoomIndex+=1);const a=o.zoomLevels[this.zoomIndex]/n,c=new i.Vector(s.pageX,s.pageY),h=t.getBoundingClientRect(),l=new i.Vector(h.left,h.top);c.subtract(l);for(let t of e.children){const e=t,s=new i.Vector(e.offsetLeft,e.offsetTop);s.subtract(c).multiply(a).add(c),(0,r.setPosition)(e,s,!1)}}))}}o.zoomLevels=[.1,.25,.33,.5,.67,.75,.8,.9,1,1.1,1.25,1.5,1.75,2,2.5,3,4,5],e.default=o}},e={};function s(i){var r=e[i];if(void 0!==r)return r.exports;var o=e[i]={exports:{}};return t[i](o,o.exports,s),o.exports}(()=>{const t=s(469),e=s(727),i=s(442),r=s(262),o=s(221),n=s(137),a=s(65);function c(t){return"string"==typeof t?t:"item"in t?`List of [${c(t.item)}]`:"element"in t?`Set of [${c(t.element)}]`:"key"in t&&"value"in t?`Dict of [${c(t.key)}] to [${c(t.value)}]`:"undefined"}class h{constructor(t,e){this.entity=t,this.elem=t.element.querySelector(`td[data-property="${e}"]`)}get element(){return this.elem}get parent(){return this.entity}}class l{constructor(t,e){this.name=t,this.elem=document.createElement("table"),this.elem.classList.add("entity");const s=document.createElement("tbody");for(const[t,i]of Object.entries(e.properties)){const r=document.createElement("td");e.keys&&t==e.keys.primary&&r.classList.add("entity-key"),r.dataset.property=t;let o=`<span class="entity-property-name">${t}</span> <span class="entity-property-type">${c(i.type)}</span>`;i.nullable?o+='<span class="entity-property-nullable"></span>':o+='<span class="entity-property-nullable nullable"></span>',r.innerHTML=o;const n=document.createElement("tr");n.append(r),s.append(n)}this.elem.insertAdjacentHTML("beforeend",`<thead><tr><th><span class="toggle"></span><span class="entity-name">${this.name}</span></th></tr></thead>`),this.elem.append(s),this.toggler.addEventListener("click",(t=>{t.preventDefault(),t.stopPropagation(),this.compact(!this.toggler.classList.contains("collapsed"))}))}get element(){return this.elem}get head(){return this.elem.querySelector("thead")}get body(){return this.elem.querySelector("tbody")}get toggler(){return this.elem.querySelector("thead>tr>th>span.toggle")}get heading(){return this.head.querySelector("span.entity-name")}compact(t){this.body.classList.toggle("hidden",t),this.toggler.classList.toggle("collapsed",t)}property(t){return new h(this,t)}}class d{constructor(t,e){this.source=t,this.target=e}}class u{constructor(e,s){this.entities=new Map,this.relationships=[],this.validate(s);for(const[t,e]of Object.entries(s.entities)){const s=new l(t,e);this.entities.set(t,s)}s.relationships.forEach((t=>{const e=this.entities.get(t.source.entity).property(t.source.property),s=this.entities.get(t.target.entity).property(t.target.property);this.relationships.push(new d(e,s))})),this.diagram=new t.DiagramCanvas(e),e.classList.add("diagram"),e.append(this.diagram.element)}validate(t){t.relationships.forEach((e=>{const s=t.entities[e.source.entity],i=t.entities[e.target.entity];s&&i||u.error(e,"entity",s,i);const r=s.properties[e.source.property],o=i.properties[e.target.property];r&&o||u.error(e,"property",r,o)}))}static error(t,e,s,i){let r;s?i||(r="target"):r="source";const o=`${t.source.entity}.${t.source.property} -> ${t.target.entity}.${t.target.property}`;throw TypeError(`${r} ${e} not found for relationship [${o}]`)}}class p extends u{constructor(t,e,s){super(t,e);const i=this.diagram.element.classList;i.add("canvaslike"),i.add("elastic"),this.layout(s)}layout(s){this.entities.forEach((t=>{t.compact(!0),this.diagram.addElement(t.element),new i.Movable(t.heading,t.element)})),this.relationships.forEach((e=>{this.diagram.addConnector(new t.Arrow(e.source.element,e.target.element))}));const o=Array.from(this.entities.values()).map((t=>t.element)),n=this.relationships.map((t=>({source:t.source.parent.element,target:t.target.parent.element}))),a=new r.default(o,n).calculate();for(let[t,e]of o.entries())e.style.left=100*a[t].x+"%",e.style.top=100*a[t].y+"%";new e.ElasticLayout(s,this.diagram.host,o,((t,e)=>this.diagram.isConnected(t,e))).initialize()}}class m extends u{constructor(t,e){super(t,e),this.diagram.element.classList.add("navigable"),this.selector=this.diagram.host.querySelector("select"),this.entities.forEach((t=>{t.compact(!0),t.heading.addEventListener("click",(e=>{e.preventDefault(),this.show(t)}));const e=document.createElement("option");e.innerText=t.name,this.selector.append(e)})),this.selector.addEventListener("change",(()=>{const t=this.entities.get(this.selector.value);t&&this.display(t)}));for(const t of this.entities.values()){this.display(t);break}}show(t){this.selector.value=t.name,this.display(t)}display(e){this.diagram.clear(),e.compact(!1);const s=this.diagram.host.querySelector(".left"),i=this.diagram.host.querySelector(".center"),r=this.diagram.host.querySelector(".right"),o=new Set;o.add(e),i.append(e.element),this.diagram.addElement(e.element),this.relationships.forEach((i=>{let n=!1;if(i.source.parent==e&&i.target.parent==e)n=!0;else if(i.target.parent==e){const t=i.source.parent;o.has(t)||(s.append(t.element),this.diagram.addElement(t.element),o.add(t)),n=!0}else if(i.source.parent==e){const t=i.target.parent;o.has(t)||(r.append(t.element),this.diagram.addElement(t.element),o.add(t)),n=!0}n&&this.diagram.addConnector(new t.Arrow(i.source.element,i.target.element))}))}}class g extends u{constructor(e,s){super(e,s);const o=this.diagram.element.classList;o.add("canvaslike"),o.add("spectral"),new n.default(this.diagram.host,this.diagram.host),new i.Pannable(this.diagram.host,this.diagram.host),this.entities.forEach((t=>{t.compact(!0),this.diagram.addElement(t.element),new i.Movable(t.heading,t.element)})),this.relationships.forEach((e=>{this.diagram.addConnector(new t.Arrow(e.source.element,e.target.element))}));const a=Array.from(this.entities.values()),c=this.relationships.map((t=>({source:t.source.parent,target:t.target.parent}))),h=new r.default(a,c).calculate();a.forEach(((t,e)=>{const s=t.element,i=h[e].x,r=h[e].y;s.style.left=80*i+10+"%",s.style.top=80*r+10+"%"}))}}const f=document.querySelector(".actions .btn-download");f&&f.addEventListener("click",(()=>{const t=document.querySelector(".tab-active>*:first-child");t&&(0,a.downloadSVG)((0,a.toSVG)(t))})),window.erd=new class{createElasticDiagram(t,e,s){return new p(t,e,s)}createNavigableDiagram(t,e){return new m(t,e)}createSpectralDiagram(t,e){return new g(t,e)}},window.TabPanel=o.default})()})();